AnzuSystems Node Development Docker Images by Petit Press a.s. (www.sme.sk)
=====

Main Node images from which all our Node flavors (versions with base, browsers...) are built. It is based on [official Node images](https://hub.docker.com/_/node) using our custom configuration.
Additionally, it contains [nginx](https://nginx.org/), [mariadb client](https://mariadb.com/downloads/) packages and many more.

[[_TOC_]]

## What's inside

- Node 20
- Node 22
- NPM
- Yarn
- AuditJS
- Supervisor
- Nginx variant:
  - Nginx
  - Nginx-xslt
  - Nginx-geoip
  - Nginx-image-filter
  - Nginx-njs
- Browsers variant:
  - google chrome
  - firefox
  - xvfb + other X libs

See versions in [version.conf](https://github.com/anzusystems/docker-node/blob/main/versions.conf) file.

### Special common commands

- `env-config` - Script to run setup of config.json file using .env files and exported variables
- `fix-user` - Corrects UID and GID for container user according to host UID and GID if needed

## Git Hooks

Setup pre-commit hook:

- `.git/hooks/pre-commit`

      #!/bin/bash
      #
      # Run update.sh script before commit

      ./update.sh
      git add .github build

## Auto-generation

Script:

    ./update.sh

This script has to be run before every commit.

Script is used to autogenerate following files/folders:

- `build/nodeXY/` - autogenerated from:
  - `config/all/`
  - `config/all-X.Y/`
  - `config/browsers/`
  - `config/browsers-X.Y/`
  - `config/nginx/`
  - `config/nginx-X.Y/`
  - `template.Dockerfile`
  - `variant-*.Dockerfile`
  - `versions.conf`
- `.github/workflows/docker.yml` - autogenerated from:
  - `docker.yml.template`
  - `docker.yml.job.template`

Do not change autogenerated files/folders directly.
